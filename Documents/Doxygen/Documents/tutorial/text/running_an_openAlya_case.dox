/*! \page running_an_openAlya_case Running an ALYA case We describe in this section the basic rules to run an openALYA case, including:- \ref Setting_the_case :        case files general description- \ref openALYA_workflow :       Alya execution workflow- \ref Running_the_case :        case execution- \ref Post_processing_results : case results review- \ref log_files : run log files review  + \ref casename_log : case run summary  + \ref casename_nsi_log : NASTIN module summary\n________\n\section Setting_the_case Setting the caseAn openALYA case is a set of files prepared to be run using some of openALYA solvers, whether in a coupled or uncoupled way, over a discretized domain and with a prescribed numerical parameterization.The case directory must contain the following files:	• casename.dat                      case global parameters	• casename.dom.dat                  domain input data		o casename.geo.dat          mesh definition		o casename.set.dat          set data: groups for post-processing, optional		o casename.fix.dat          boundary conditions data	• casename.ker.dat                  kernel parameters (common to all modules)	• casename.'module'.dat             physics modules: 'nsi' (NASTIN), 'tur' (TURBUL)	• casename.post.alya.dat            post process parameters used by alya2pos appThe files geo.dat, set.dat and fix.dat are read through INCLUDE commands in the dom.dat file. As an option, the data contained in this files may be directly listed in the dom.dat file. In that situation geo.dat, set.dat and fix.dat files do not exist as separate files. Every tutorial in this manual includes the listing and description of these files, with short comments to commands and options ($…).We suggest the new user to do the tutorials by himself, changing parameters and running again the cases, comparing results and understanding the differences. This is the best way to get started with openALYA and the use of CFD in general.The reading of online openALYA documentation is a must to complete the learning of basic user skills and get an insight into openALYA capabilities.\n________\n\section openALYA_workflow openALYA workflowAn important issue to understand in order to use Alya in an efficient way is the workflow of Alya execution. The following diagram shows the scheme of Alya multi-level iterations, where we can observe the different loop levels that may be used during case solving:\image html bucles_alya.png			• time loop 	 (n)	time step progression			• coupling loop (j)	physics modules coupling			• inner loop	 (i)	physics module resolution (i.e. Nastin solution)			• solver loop	 (k)	algebraic solver execution (direct or iterative)\nThe workflow in the figure shows the two types of coupling that Alya can manage:	• strong coupling: the modules NASTIN and TURBUL are coupled in this way, since both have to converge in two 			   consecutive coupled iterations for the coupling loop to be converged	• soft coupling:   the module CHEMIC is coupled in this way with NASTIN+TURBUL, since it is solved after the			   convergence of two both, without influencing on their results\n________\n \section Running_the_case Running the caseTo run a case with openALYA open a terminal, go to the directory where case input files are located and execute:	/path/Executables/unix/Alya.x casenamethen openALYA starts reading \e casename case input files and runs the simulation. The terminal echoes the tracking of the calculations, listing timstep progression.The path to the directory where Alya installation is located must be added, or include the complete path to Alya.x in the terminal configuration file.Parallel execution is performed through mpi line command:	/path/Executables/unix/mpirun –np N Alya.x casenamewhere N is the number of CPUs. Note that in all runs there is one master CPU, devoted to conduct the simulation, so that N-1 partitions will be done on the mesh.Meanwhile the simulation is running, graphical visualization of convergence evolution is done by the application:	/path/Utils/user/alya-all-nsi casenameThis openALYA utility will display in real time convergence plots (see next figure), with the following meanings:	Top Left:     norm of convergence of Momentum (red curve) and Continuity (green curve) momentum and continuity                      solvers residuals are plotted for every algebraic solver iteration, within each module inner                      iteration, within every time step iteration	Top Right:    velocity (red curve) and pressure (green curve) residuals are plotted for every algebraic	solver                      iteration, within each module inner iteration, within every time step iteration; residuals are evaluated with the expression:	\n<CENTER>                       \f$ \mbox{Linf} = \mbox{max}_{all\_nodes} (V_k {-} V_{k-1}), \mbox{max}_{all\_nodes} (p_k {-} p_{k-1}) \f$</CENTER>                       \n	Bottom Left:  maximum velocity and minimum & maximum pressures at every solver iteration	Bottom Right: Number of iterations of algebraic solvers. Note that momentum solver does the double of iterations                      than continuity solver, because in the case of the example Schur algorithm is specified in                      ‘nsi.dat’ file, which has a MSM scheme (Momentum-Schur-Momentum). \n\image html convergence_graph.png \n________\n\section Post_processing_results Post processing resultsa)  To generate result files in a format compatible with open-source post-processing tools such as ParaView or Visit, execute in the case directory the command:	/path/Utils/user/alya2pos/alya2pos.x casenameThe application alya2pos.x generates the file casename.ensi.case which is directly read by diverse post-processors,depending on the parameterization of casename.post.alya.dat file.The app may be run with the simulation on the fly, in order to inspect results meanwhile.b)  To process resultant forces, torques and/or mass flow at desired boundaries, use the application:	/path/Utils/user/alya-sets casename-boundary.nsi.set boundary_set#1 ... boundary_set#nThe application alya-sets reads the file casename-boundary.nsi.set and does the summation of boundary variables specified in casename.nsi.dat / BOUNDARY_SET, for all elements belonging to boundary_set#1 ... boundary_set#n. Results are written to file alya-sets.out and can be easily plotted with an application such as gnuplot.c)  To erase all files produced by the previous Alya run, execute in the case directory:	/path/Utils/user/alya-clean\n________\n\section log_files Case run log files\nopenALYA runs produce several log files; principal run facts are listed in the following files:\n\subsection casename_log casename.log\n----------A L Y A: 	backward_facing_step----------------------------------------------------BOUNDARY CONDITION CODES------------------------------------------        CODE=             1        CODE=             1  &  3        CODE=             2        CODE=             2  &  3        CODE=             3------------------------------------------SUMMARY OF PROBLEM DATA------------------------------------------        GENERAL DATA:        MODULES SOLVED:        	NASTIN, KERMOD        BLOCK DEFINITION:       1:NASTIN        TIME STEP STRATEGY:    	PRESCRIBED        TIME STEP=              0.100000E-01        TIME RANGE=             0.000000E+00, 0.600000E+02        DOMAIN DATA:        DOMAIN DIMENSION=  	2        NUMBER OF NODES=     	14681        .....................         BANDWIDTH=              13382					Matrix Bandwidth        PROFILE=                0.805E+08        .....................         TOTAL VOLUME=           0.640000E+02				Domain volume (surface for 2D models)        AVE. ELEMENT VOLUME=    0.444444E-02				Average element volume        MIN. ELEMENT VOLUME=    0.266029E-03 (ELEMENT     12800)	Minimum element volume        MAX. ELEMENT VOLUME=    0.108131E-01 (ELEMENT      5839)	Maximum element volume        .....................         NUMBER OF ELEMENTS=     14400        ELEMENTS USED:          14400 QUA04        GAUSS POINTS (RULE)=    4(open)					Number of Gauss point per element and rule        .....................         NUMBER OF BOUNDARIES=  560        BOUNDARIES USED:       560 BAR02        GAUSS POINTS (RULE)=   2(open) 					Number of Gauss point per element and rule----------------------------------------SUMMARY OF CONVERGENCE----------------------------------------        TIME STEP NUMBER:       1					for every time step        CURRENT TIME STEP dt = 	0.100000E-01        CURRENT TIME            t = 0.100000E-01        NASTIN:             CRITICAL TIME STEP DTC:  0.707854E-02				             RATIO DT/DTC:            0.141272E+01		r atio current time step / critical time step        GLOBAL ITERATION NUMBER:      1, BLOCK NUMBER:  1        CURRENT CPU TIME:             0.276773E+02        RESIDUAL OF VELOCITY    :     0.610723E+00 (%)        RESIDUAL OF PRESSURE    :     0.100000E+01 (%)        TIME STEP NUMBER:     	2        CURRENT TIME STEP  dt = 0.100000E-01        CURRENT TIME        t = 0.200000E-01        NASTIN:             CRITICAL TIME STEP DTC:  0.256083E-02             RATIO DT/DTC:            0.390498E+01        GLOBAL ITERATION NUMBER:      1, BLOCK NUMBER:  1        CURRENT CPU TIME:             0.517288E+02        RESIDUAL OF VELOCITY    :     0.417159E-01 (%)        RESIDUAL OF PRESSURE    :     0.332133E+02 (%): ::        TIME STEP NUMBER:  	6001        CURRENT TIME STEP dt =  0.100000E-01        CURRENT TIME        t = 0.600100E+02        NASTIN:             CRITICAL TIME STEP DTC: 	0.352812E-02             RATIO DT/DTC:              0.283437E+01        GLOBAL ITERATION NUMBER:     	1, BLOCK NUMBER:  1        CURRENT CPU TIME:               0.367235E+05        RESIDUAL OF VELOCITY      :     0.440466E-02 (%)        RESIDUAL OF PRESSURE      :     0.510596E-02 (%)------------------------------------------------SUMMARY OF REQUIRED MEMORY------------------------------------------------        TOTAL MEMORY:                 13.98 Mbytes        CONSTRUCTION OF THE DOMAIN:    2.79 Mbytes ( 19.96 %)        MESH GENERATION:               0.00 Mbytes (  0.00 %)        NASTIN MODULE:                 1.51 Mbytes ( 10.78 %)        KERMOD MODULE:                 0.00 Mbytes (  0.00 %)        SOLVERS:                       9.68 Mbytes ( 69.25 %)        MAXIMUM MEMORY REQUIRED:      18.13 Mbytes----------------------------------------------SUMMARY OF COMPUTING TIMES----------------------------------------------        TOTAL CPU TIME:            36723.52        STARTING OPERATIONS:           0.11 (  0.00 % )             Reading data:             0.01 (  0.00 % )             Domain construction:      0.10 (  0.00 % )        NASTIN MODULE:             36722.11 (100.00 % )             Matrix construction:  17811.94 ( 48.50 % )             Algebraic solver:     18761.38 ( 51.09 % )             Postprocess:              1.34 (  0.00 % )        KERMOD MODULE:                 0.00 (  0.00 % )             Matrix construction:      0.00 (  0.00 % )             Algebraic solver:         0.00 (  0.00 % )             Postprocess:              0.00 (  0.00 % )        OTHER OPERATIONS:      	       1.30 (  0.00 % )----------------------------------------------OTHER TASKS COMPUTING TIMES----------------------------------------------        MESH MULTIPLICATION:    	0.00          Edge table:                   0.00 ( 28.04 % )          Face table:                   0.00 (  0.88 % )          Element divisor:              0.00 ( 71.07 % )          Parall, own nodes:            0.00 (  0.00 % )          Parall, common edges:    	0.00 (  0.00 % )          Parall, common faces:      	0.00 (  0.00 % )          Parall, boundaries:           0.00 (  0.00 % )          Parall, loc. renumbering:  	0.00 (  0.00 % )          Parall, glo. numbering:    	0.00 (  0.00 % )------------------------END OF ANALYSIS------------------------\n____\n\subsection casename_nsi_log casename.nsi.log\n--------------------------NASTIN OUTPUT FOR PROBLEM: backward_facing_step-----------------------------------------------DIFFERENTIAL EQUATION---------------------        rho*du/dt + rho*(u.grad)u - div[mugrad(u)] + grad(p) =0        rho*div(u)=0--------------------------SUMMARY OF COMPUTING TIMES--------------------------        TOTAL CPU TIME:              		36722.11        ELE+BOUN MATRIX AND RHS ASS  		15821.43 ( 43.08 % )        SOLVER   MOMENTUM=            		3268.81  (  8.90 % )        SOLVER   CONTINUITY=         		15492.57 ( 42.19 % )        VELOCITY CORRECTION=             	0.00     (  0.00 % )        OTHERS                        		2139.30  (  5.83 % )-----------------UMMARY OF SOLVER-----------------MOMENTUM:---------        SOLVER:               	GMRES        # SOLVES=               277286        PRECONDITIONER:       	LEFT: DIAGONAL diag(A)        MIN. # ITERATIONS=      0        MAX. # ITERATIONS=      13        AVE. # ITERATIONS=      5        TOT. # ITERATIONS=     	1643250        TOT. CPU TIME=         	0.32688138E+004        SUMMARY OF SOLVER TIMES:        TOTAL SOLVER CPU TIME:  	0.326881E+04          Initial operations:         	0.456859E+03 ( 13.98 % )          Preconditioning:            	0.172349E+04 ( 52.73 % )          Coarse system solver (DCG):   0.000000E+00 (  0.00 % )          Orthogonalization (GMRES):    0.494818E+03 ( 15.14 % )          Others:                     	0.593643E+03 ( 18.16 % )CONTINUITY:-----------        SOLVER:                 DEFLATED CONJUGATE GRADIENT        # SOLVES=               138643        NUMBER OF GROUPS=       10        PRECONDITIONER:       	LEFT: DIAGONAL diag(A)        MIN. # ITERATIONS=      6        MAX. # ITERATIONS=      658        AVE. # ITERATIONS=      119        TOT. # ITERATIONS=    	16521954        TOT. CPU TIME=         	0.15492571E+005        SUMMARY OF SOLVER TIMES:        TOTAL SOLVER CPU TIME:          0.154926E+05          Initial operations:         	0.102440E+03 (  0.66 % )          Preconditioning:            	0.563126E+04 ( 36.35 % )          Coarse system solver (DCG):   0.594332E+03 (  3.84 % )          Orthogonalization (GMRES):    0.000000E+00 (  0.00 % )          Others:                     	0.916454E+04 ( 59.15 % )        END OF NASTIN RUN____\n*/