cmake_minimum_required(VERSION 2.8 FATAL_ERROR)

get_filename_component(ProjectId ${CMAKE_CURRENT_LIST_DIR} NAME)
string(REPLACE " " "_" ProjectId ${ProjectId})

project(${ProjectId} LANGUAGES Fortran)
file(GLOB_RECURSE SRC_FILES ${CMAKE_HOME_DIRECTORY}/unitt/${PROJECT_NAME}/*.f90)

add_executable(${PROJECT_NAME} ${SRC_FILES})

include(compiler)
set_flags()
set_defs()
set_openmpi()

include_directories(${alya-core_MODULE_DIR})

target_link_libraries(${PROJECT_NAME} alya-core c)

set_target_properties(${PROJECT_NAME} PROPERTIES POSITION_INDEPENDENT_CODE ON)
set_target_properties(${PROJECT_NAME} PROPERTIES LINKER_LANGUAGE Fortran)

add_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})
