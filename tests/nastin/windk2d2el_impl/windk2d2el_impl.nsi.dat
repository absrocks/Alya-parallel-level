$------------------------------------------------------------
PHYSICAL_PROBLEM
$------------------------------------------------------------
PROBLEM_DEFINITION  
 TEMPORAL_DERIVATIVES:     On  
 CONVECTIVE_TERM:          On
 VISCOUS_TERM:             LAPLACIAN
$ TURBULENCE_COUPLING:       LESMO, WALE , PARAM=0.25
END_PROBLEM_DEFINITION  
$------------------------------------------------------------ 
END_PHYSICAL_PROBLEM  
$------------------------------------------------------------
$------------------------------------------------------------
NUMERICAL_TREATMENT  $implicit
ELEMENT_LENGTH:           Minimum
  STABILIZATION:            ASGS
  $TRACKING:                 Time, CONVECTION, ITERAT=100, TOLER=1.0e-5, RELAX=1.0, ORDER=1, NEWTON
  $$TIME_INTEGRATION:         Trapezoidal, ORDER: 1, EULER=20
  TIME_INTEGRATION:         BDF, ORDER: 2, EULER=20
  SAFETY_FACTOR:            0.5 $$$0.0 expon 1.05 maxim 250.0 $$$antes 100.0
  STEADY_STATE_TOLER:       -1e-12

  $$ VECTORIZED_ASSEMBLY:      ON

  NORM_OF_CONVERGENCE:      LAGGED_ALGEBRAIC_RESIDUAL
  MAXIMUM_NUMBER_OF_IT:     20
  CONVERGENCE_TOLERANCE:    1e-3

  ALGORITHM:                SCHUR
    SOLVER:                 ORTHOMIN, CONTINUITY_PRESERVING
    PRECONDITIONER:         DT
    ELEMENT_LENGTH:         Minimum
    TAU_STRATEGY:           Codina
  END_ALGORITHM

  MOMENTUM
    ALGEBRAIC_SOLVER     
      SOLVER:                GMRES, KRYLOV=20
      CONVERGENCE:           ITERA=1000, TOLER=1.0e-10, ADAPTIVE, RATIO=0.01
      OUTPUT:                CONVERGENCE
      PRECONDITIONER:        DIAGONAL
    END_ALGEBRAIC_SOLVER        
  END_MOMENTUM
  CONTINUITY 
    ALGEBRAIC_SOLVER
       SOLVER:               DEFLATED_CG, COARSE: SPARSE
       CONVERGENCE:          ITERA=1000, TOLER=1.0e-10, ADAPTIVE, RATIO=0.001
       OUTPUT:               CONVERGENCE
       PRECONDITIONER:       DIAGONAL
    END_ALGEBRAIC_SOLVER        
  END_CONTINUITY



END_NUMERICAL_TREATMENT
$------------------------------------------------------------
OUTPUT_&_POST_PROCESS
  START_POSTPROCES_AT       STEP  = 0
$  POSTPROCESS VELOCITY,     STEPS = 20 $every 0.1s
$  POSTPROCESS PRESS,        STEPS = 20 $every 0.1s
  BOUNDARY_SET
    MASS
    MEANP
  END_BOUNDARY_SET

  WITNESS_POINTS
    VELOZ    
  END_WITNESS_POINTS

END_OUTPUT_&_POST_PROCESS
$------------------------------------------------------------
$------------------------------------------------------------
BOUNDARY_CONDITIONS
   PARAMETERS
      INITIAL:   CONSTANT, VALUE=0.0,0.0,0.0
      VARIATION: NON_CONSTANT
   END_PARAMETERS

   CODES, BOUNDARIES
       2 20 0 0.0 0.0 1 windk_function: outlet   
$       1 2 1 space_time_function=ramp
   END_CODES

   CODES, NODES
      1     111 1 0 0, AXES=LOCAL   
$      2     000 0 0 0 
      1 & 3 111 0.0 0.0 0.0   $wall      
      2 & 3 111 0.0 0.0 0.0   $wall      
      3     111 0.0 0.0 0.0   $wall     
   END_CODES
    
   FLOW_RATE= -1, TIME_FUNCTION=inlet, CODE= 1 

END_BOUNDARY_CONDITIONS  
$------------------------------------------------------------ 
