$------------------------------------------------------------
PHYSICAL_PROBLEM                                             
  include ./case-067.nsi.inc
END_PHYSICAL_PROBLEM                                         
$------------------------------------------------------------
NUMERICAL_TREATMENT 
  ELEMENT_LENGTH           minimum
  STABILIZATION            ASGS nogrv
  TIME_INTEGRATION         Trapezoidal, ORDER: 1, EULER=10
  STEADY_STATE_TOLER       1d-10
  STOP_BY_WITNESS
  NORM_OF_CONVERGENCE      LAGGED_ALGEBRAIC_RESIDUAL
  MAXIMUM_NUMBER_OF_IT     1
  CONVERGENCE_TOLERANCE    1d-8    ! ortomin
  VECTORIZATION OFF
  ALGORITHM                SCHUR
    SOLVER                 ORTHOMIN, MOMENTUM_PRESERVING
    PRECONDITIONER         TAU
    ELEMENT_LENGTH         minimum
    TAU_STRATEGY           Codina
    CORRECTION             open
  END_ALGORITHM
  SAFETY_FACTOR            2.0 expon 1.05  maxim 10.0 mingl 20.0 
  MOMENTUM
    ALGEBRAIC_SOLVER       GMRES, KRYLOV=80,ITERA=100, TOLER=1.0e-10, ADAPTIVE, RATIO=1e-3, CONVER
    PRECONDITIONER         DIAGONAL                                                                 
  END_MOMENTUM
  CONTINUITY
    ALGEBRAIC_SOLVER       DEFLATED_CG, ITERA=500, TOLER=1.0e-8, ADAPTIVE, RATIO=1e-4, CONVER,UNSYMME
    PRECONDITIONER         LINELET                                                                  
  END_CONTINUITY
END_NUMERICAL_TREATMENT  
$------------------------------------------------------------
OUTPUT_&_POST_PROCESS  
  START_POSTPROCES_AT       STEP  = 0
  POSTPROCESS VELOCITY      STEPS = 100
  POSTPROCESS PRESSURE      STEPS = 100
$  POSTPROCESS FIXNO         STEPS = 100
$  POSTPROCESS FIXPR         STEPS = 100
$  POSTPROCESS SCHUR         STEPS = 100
  WITNESS_POINTS
    VELOX
    VELOY
    VELOZ
    PRESS
  END_WITNESS_POINTS
END_OUTPUT_&_POST_PROCESS  
$------------------------------------------------------------
BOUNDARY_CONDITIONS
  CODES,  NODES, GEOMETRICAL
    -11 1  ! use field 1 for inflow profile
  END_CODES
 CODES, BOUNDARIES
  1                20      0.0                00      1         1
  2                20      0.0                00      1         2
  3                20      0.0                00      1         3
  4                20      0.0                00      1         4
  END_CODES
  PARAMETER
     INITIAL VALUE_FUNCTION = 1 ! use field 1 for initial condition
  END_PARAMETER
END_BOUNDARY_CONDITIONS  
$------------------------------------------------------------
