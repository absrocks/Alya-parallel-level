$------------------------------------------------------------
PHYSICAL_PROBLEM
$------------------------------------------------------------ 
PROBLEM_DEFINITION       
  TEMPORAL_DERIVATIVES:     On 
  CONVECTIVE_TERM:          On
  VISCOUS_TERM:             LAPLACIAN
$  VISCOUS_TERM:             Full
END_PROBLEM_DEFINITION  
$------------------------------------------------------------
PROPERTIES
  INITIAL_FIELDS
    VEFOR         FIELD = 2
    PRFOR         FIELD = 1
  END_INITIAL_FIELDS
END_PROPERTIES
$------------------------------------------------------------
END_PHYSICAL_PROBLEM  
$------------------------------------------------------------
NUMERICAL_TREATMENT 
  ELEMENT_LENGTH:           Minimum
  STABILIZATION:            ASGS
  TIME_INTEGRATION:         Trapezoidal, ORDER= 1, EULER=20
  SAFETY_FACTOR=            20.0 
  STEADY_STATE_TOLER=       1e-2

  NORM_OF_CONVERGENCE:      LAGGED_ALGEBRAIC_RESIDUAL
  MAXIMUM_NUMBER_OF_IT=     1

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ SACAR DE UNA VEZ
  VECTORIZATION: OFF
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  CONVERGENCE_TOLERANCE=    1e-14

  ALGORITHM:                SCHUR
   SOLVER:                 ORTHOMIN, MOMENTUM_PRESERVING
$    SOLVER:                 ORTHOMIN, CONTINUITY_PRESERVING
    PRECONDITIONER:         TAU
    ELEMENT_LENGTH:         Minimum
    TAU_STRATEGY:           Codina
  END_ALGORITHM

  MOMENTUM
    ALGEBRAIC_SOLVER     
      SOLVER:                GMRES, KRYLOV=50
      CONVERGENCE:           ITERA=1000, TOLER=1.0e-12, ADAPTIVE, RATIO=0.0005
      OUTPUT:                CONVERGENCE
      PRECONDITIONER:        DIAGONAL
 $     OPTION:                REACTION
    END_ALGEBRAIC_SOLVER
  END_MOMENTUM
  CONTINUITY 
    ALGEBRAIC_SOLVER
       SOLVER:               DEFLATED_CG $, COARSE: SPARSE
       CONVERGENCE:          ITERA=500, TOLER=1.0e-12, ADAPTIVE, RATIO=0.0001
       OUTPUT:               CONVERGENCE
       PRECONDITIONER:       DIAGONAL
    END_ALGEBRAIC_SOLVER    
  END_CONTINUITY

END_NUMERICAL_TREATMENT  
$------------------------------------------------------------
OUTPUT_&_POST_PROCESS  
  START_POSTPROCES_AT       STEP  = 0
  POSTPROCESS VELOCITY,     STEPS = 1
  POSTPROCESS PRESSURE,     STEPS = 1
  POSTPROCESS SENSM,        STEPS = 1
  BOUNDARY_SET
    FORCE
    TORQUE, CENTER=0,0,0
    MASS
$    INTFX
$    INTFY
  END_BOUNDARY_SET
END_OUTPUT_&_POST_PROCESS  
$------------------------------------------------------------
BOUNDARY_CONDITIONS

  PARAMETERS
    INITIAL: CONSTANT, VALUE=0.0,0.0,0.0
  END_PARAMETERS
  CODES, NODES
        1  111  0.000000  0.000000 0.000
        2  000  0.000000  0.000000 0.000
        3  111  0.000000  0.000000 0.000
        6  111  0.000000  0.000000 0.000
        4  010  0.000000  0.000000 0.000
        5  001  0.0       0.0      0.0  
    5 & 3  111  0.000000  0.000000 0.000
    5 & 6  111  0.000000  0.000000 0.000
    4 & 5  011  0.000000  0.000000 0.000  
    1 & 4  111  0.000000  0.000000 0.000
    2 & 4  010  0.000000  0.000000 0.000  
    1 & 5  111  0.000000  0.000000 0.000
    2 & 5  001  0.000000  0.000000 0.000      
    5 & 1 & 4  111  0.000000  0.000000 0.000
    5 & 2 & 4  011  0.000000  0.000000 0.000
    6 & 3  111  0.000000  0.000000 0.000

  END_CODES
 
  CODES, BOUNDARIES
    3  1
    6  1
  END_CODES


END_BOUNDARY_CONDITIONS  
$------------------------------------------------------------
