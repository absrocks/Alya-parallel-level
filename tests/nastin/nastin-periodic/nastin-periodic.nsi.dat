$------------------------------------------------------------
PHYSICAL_PROBLEM
$------------------------------------------------------------ 
PROBLEM_DEFINITION       
  TEMPORAL_DERIVATIVES:     On 
  CONVECTIVE_TERM:          On
  VISCOUS_TERM:             LAPLACIAN
  GRAVITY:                  NORM= 1.0, GX=1.0,GY=0.0
END_PROBLEM_DEFINITION  
$------------------------------------------------------------
END_PHYSICAL_PROBLEM  
$------------------------------------------------------------
NUMERICAL_TREATMENT 
  ELEMENT_LENGTH:           Minimum
  STABILIZATION:            ASGS
  TIME_INTEGRATION:         Trapezoidal, ORDER: 1, EULER=20
  SAFETY_FACTOR:            10.0
  STEADY_STATE_TOLER:       -1e-12

  NORM_OF_CONVERGENCE:      LAGGED_ALGEBRAIC_RESIDUAL
  MAXIMUM_NUMBER_OF_IT:     1
  CONVERGENCE_TOLERANCE:    1e-3

  VECTORIZED_ASSEMBLY:      ON

  ALGORITHM:                SCHUR
    SOLVER:                 ORTHOMIN, CONTINUITY_PRESERVING
    PRECONDITIONER:         TAU
    ELEMENT_LENGTH:         Minimum
    TAU_STRATEGY:           Codina
  END_ALGORITHM

  MOMENTUM
    ALGEBRAIC_SOLVER     
      SOLVER:                GMRES, KRYLOV=10
      CONVERGENCE:           ITERA=1000, TOLER=1.0e-12, ADAPTIVE, RATIO=0.01
      OUTPUT:                CONVERGENCE
      PRECONDITIONER:        DIAGONAL
    END_ALGEBRAIC_SOLVER        
  END_MOMENTUM
  CONTINUITY 
    ALGEBRAIC_SOLVER
       SOLVER:               DEFLATED_CG
       CONVERGENCE:          ITERA=1000, TOLER=1.0e-12, ADAPTIVE, RATIO=0.01
       OUTPUT:               CONVERGENCE
       PRECONDITIONER:       DIAGONAL
    END_ALGEBRAIC_SOLVER        
  END_CONTINUITY
 
  DIRICHLET: MATRIX

END_NUMERICAL_TREATMENT  
$------------------------------------------------------------
OUTPUT_&_POST_PROCESS  
$  OUTPUT,     ERROR,        SOLUTION = 13, DIRICHLET: OFF
  postprocess VELOC, steps=1e6
  postprocess PRESS, steps=1e6
END_OUTPUT_&_POST_PROCESS   
$------------------------------------------------------------
BOUNDARY_CONDITIONS
  PARAMETERS
    FIX_PRESSURE: On, ON_NODE=5, VALUE=1.0
$    FIX_PRESSURE: On, ON_NODE=5, VALUE=3.5
    VARIATION: NON_CONSTANT
  END_PARAMETERS 
  CODES, NODES
      1  00  0.0 0.0
  1 & 2  11  0.0 0.0
      2  11  0.0 0.0 
  2 & 3  11  0.0 0.0
      3  00  0.0 0.0
  3 & 4  11  0.0 0.0
      4  11  0.0 0.0
  4 & 1  11  0.0 0.0
  END_CODES
$  CODES, NODES
$      1  00  0.0 0.0
$  1 & 2  11  1.0 1.0, SPACE_TIME_FUNCTION=EXACT_SOLUTION
$      2  11  1.0 1.0, SPACE_TIME_FUNCTION=EXACT_SOLUTION 
$  2 & 3  11  1.0 1.0, SPACE_TIME_FUNCTION=EXACT_SOLUTION
$      3  00  0.0 0.0
$  3 & 4  11  1.0 1.0, SPACE_TIME_FUNCTION=EXACT_SOLUTION
$      4  11  1.0 1.0, SPACE_TIME_FUNCTION=EXACT_SOLUTION
$  4 & 1  11  1.0 1.0, SPACE_TIME_FUNCTION=EXACT_SOLUTION
$  END_CODES
END_BOUNDARY_CONDITIONS  
$------------------------------------------------------------
