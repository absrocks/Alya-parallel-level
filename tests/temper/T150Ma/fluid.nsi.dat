$$Create by J. MIGUEL ZAVALA-AKE 
$------------------------------------------------------------
PHYSICAL_PROBLEM
  $
  PROBLEM_DEFINITION       
    TEMPORAL_DERIVATIVES:   On 
    CONVECTIVE_TERM:        On
    VISCOUS_TERM:           LAPLACIAN $FULL
   $REGIME:                 INCOMPRESSIBLE
    REGIME:                 LOWMACH, TEMPERATURE = 288.15  
  END_PROBLEM_DEFINITION  
  $
  PROPERTIES
  $$LOWMACH:
    THERMODYN_PRESSURE = 101325.00          $$ Rho = 101325.0/(8.314621/0.0289531 * 288.15) = 1.2244769127021613  
    GAS_CONSTANT       =    287.175501069   $$ @ U.S. Standard Atmosphere (1976)  
  END_PROPERTIES  
  $
END_PHYSICAL_PROBLEM  

$------------------------------------------------------------
NUMERICAL_TREATMENT 
  STABILIZATION:            ASGS
  ELEMENT_LENGTH:           Minimum
TIME_INTEGRATION:         Trapezoidal, ORDER: 1, EULER=5
$$TIME_INTEGRATION:         BDF, ORDER:2, EULER=10
  SAFETY_FACTOR:            1e3 EXPON 1.02 1e6 
  STEADY_STATE_TOLER:      -1e-12
  NORM_OF_CONVERGENCE:      LAGGED_ALGEBRAIC_RESIDUAL
  MAXIMUM_NUMBER_OF_IT:     10 

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ SACAR DE UNA VEZ
  VECTORIZATION: OFF
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
 
  CONVERGENCE_TOLERANCE:    1e-16  
  ALGORITHM:                SCHUR
    SOLVER:                 ORTHOMIN, CONTINUITY_PRESERVING
    PRECONDITIONER:         DT
    ELEMENT_LENGTH:         MINIMUM
    TAU_STRATEGY:           CODINA
  END_ALGORITHM
  MOMENTUM
    ALGEBRAIC_SOLVER:       GMRES,  ITERA=1000, TOLER=1.0e-18, ADAPTIVE, RATIO=0.01, KRYLOV=30, CONVERGENCE
    PRECONDITIONER:         DIAGONAL
  END_MOMENTUM 
  CONTINUITY
    ALGEBRAIC_SOLVER:       DEFLATED_CG, ITERA=1000, TOLER=1.0e-18, ADAPTIVE, RATIO=0.001, UNSYMME, CONVERGENCE
    PRECONDITIONER:         DIAGONAL 
  END_CONTINUITY

  DIRICHLET:                MATRIX
  INTERNAL_FORCES:          RESIDUAL

END_NUMERICAL_TREATMENT  

$------------------------------------------------------------
OUTPUT_&_POST_PROCESS 
  POSTPROCESS  INITIAL
  POSTPROCESS  VELOCITY
  POSTPROCESS  TRACT
 $POSTPROCESS  TTRAC
 $POSTPROCESS  REACT
  POSTPROCESS  PRESSURE
 $POSTPROCESS  MACHN
 $POSTPROCESS  DENSITY <- kernel
  $
  WITNESS_POINTS
    VELOY
  END_WITNESS_POINTS
  $
  BOUNDARY_SET
    WETFO
   $INTFX $  MEMORY FOR TAU_WALL COULD NOT BE DEALLOCATED
   $INTFY
   $INTFZ
    F_v_x
    F_v_y
    F_v_z
    F_v_x
    F_p_y
    F_p_z
    FORCE
  END_BOUNDARY_SET
  $
END_OUTPUT_&_POST_PROCESS   

$------------------------------------------------------------
BOUNDARY_CONDITIONS
  $
  PARAMETERS
    $
   $INITIAL: VALUE = 1
    VARIATION:    NON_CONSTANT                   $< FUNCTION
    INITIAL:           INERTIAL, Value= 0.0 0.0 
    $
  END_PARAMETERS
  $
  CODES, NODES 
    INCLUDE fluid.nsi.codes   
  END_CODES
  $
END_BOUNDARY_CONDITIONS  
$------------------------------------------------------------
