$-------------------------------------------------------------------
$
$ pzt-actuator_repart
$ Details:   Piezoelectric actuator for wave propagation using solidz repartitioning
$
$            # Piezo-electric material properties
$            E_PZT = 7.25e+10    # Young Modulus
$            v_PZT = 0.31        # Poisson ratio
$            h_PZT = 1.0e-3      # Total thickness
$            R     = 5.0e-3      # Radius
$            d31   = -170.0e-12  # Induced strain in 1 per unit electric field applied in direction 3
$
$            # Excitation parameters
$            Np = 5.           # Peak number
$            P  = 55.          # Signal intensity
$            fc = 50e+3        # Central frequency (Hz)
$            T  = 1.1e-4       # Total time (s)
$            freq = 1e-6       # Frequency (time step size)
$
$            The excitation signal is genenerated with the python
$            script pzt_d-t.py
$
$ Units:     SI(m)
$
$ Reference: SHERLOC project
$
$-------------------------------------------------------------------
PHYSICAL_PROBLEM
  PROBLEM_DEFINITION
    TEMPORAL_DERIVATIVES: DYNAMIC
  END_PROBLEM_DEFINITION
  PROPERTIES
    MATERIAL           = 1
    DENSITY            = 7800.0
    CONSTITUTIVE_MODEL: ISOLIN \
      7.25e+10  0.31
  END_PROPERTIES
END_PHYSICAL_PROBLEM
$-------------------------------------------------------------------
NUMERICAL_TREATMENT
$  TIME_TREATMENT:      EXPLICIT
$  TIME_INTEGRATION:    NEWMARK, CDIFF
$  NO_STEADY_STATE
$  SAFETY_FACTOR=       0.70
  $----------------------------------------
  TIME_TREATMENT:      IMPLICIT
  TIME_INTEGRATION:    NEWMARK, DAMPED
  NO_STEADY_STATE
  ALGEBRAIC_SOLVER
$    SOLVER:            DIRECT
    SOLVER:            GMRES, KRYLOV=100
    CONVERGENCE:       ITERA=200, TOLER=1.0E-8
    PRECONDITIONER:    DIAGONAL, LEFT
    COARSE:            OFF
    RESIDUAL:          RHS
    OPTIONS:           ZERO_FIXITY
    OUTPUT:            CONVERGENCE
  END_ALGEBRAIC_SOLVER
  CONVERGENCE_TOLER=   1.0e-6
  MAXIMUM_ITERATION=   200
  RESIDUAL:            DISPL
  SAFETY_FACTOR=       1.0
END_NUMERICAL_TREATMENT
$-------------------------------------------------------------------
OUTPUT_&_POST_PROCESS
  START_POSTPROCESS_AT, STEP  = 0
$  POSTPROCESS FIXNO
$  POSTPROCESS FIXRS
$  POSTPROCESS ROTM1
$  POSTPROCESS ROTM2
$  POSTPROCESS ROTM3
$  POSTPROCESS BVESS
  POSTPROCESS DISPL
  NODE_SET
    DISPX
    DISPY
    DISPY
  END_NODE_SET
END_OUTPUT_&_POST_PROCESS
$-------------------------------------------------------------------
BOUNDARY_CONDITIONS, TRANSIENT
  CODES, NODES
        1 100 0.0 0.0 0.0                                          $ Fixed bot face
    1 & 3 100 0.0 0.0 0.0                                          $ Fixed bot edge
    2 & 3 100 0.0 0.0 0.0, AXES: LOCAL_BASIS=1, MODULE_FUNCTION= 1 $ Apply displ. (radial)
  END_CODES
  FUNCTIONS
    TOTAL_NUMBER = 1
    CONDITION
      FUNCTION_NUMBER: 1
      TIME_SHAPE: DISCRETE, LINEAR
      SHAPE_DEFINITION
        INCLUDE ./d-t_Amp-50kHz.bc
      END_SHAPE_DEFINITION
    END_CONDITION
  END_FUNCTIONS
END_BOUNDARY_CONDITIONS
$-------------------------------------------------------------------
