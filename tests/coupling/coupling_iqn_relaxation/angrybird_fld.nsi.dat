$------------------------------------------------------------
PHYSICAL_PROBLEM
$------------------------------------------------------------ 
PROBLEM_DEFINITION       
  TEMPORAL_DERIVATIVES:     On 
  CONVECTIVE_TERM:          ON $SKEW_SYMMETRIC
  VISCOUS_TERM:             LAPLACIAN
END_PROBLEM_DEFINITION  

END_PHYSICAL_PROBLEM  

$------------------------------------------------------------
NUMERICAL_TREATMENT 

  ELEMENT_LENGTH:           Minimum

  STABILIZATION:            ASGS

  TIME_INTEGRATION:         Trapezoidal, ORDER: 1, EULER=10

  SAFETY_FACTOR:            100.0

  STEADY_STATE_TOLER:       1e-12

  NORM_OF_CONVERGENCE:      LAGGED_ALGEBRAIC_RESIDUAL

  MAXIMUM_NUMBER_OF_IT:     500

  CONVERGENCE_TOLERANCE:    1e-5

   TRACKING:                 TIME

  ALGORITHM:                SCHUR
    SOLVER:                 ORTHOMIN, CONTINUITY_PRESERVING
    PRECONDITIONER:         DT
    ELEMENT_LENGTH:         Minimum
    TAU_STRATEGY:           Codina
  END_ALGORITHM

  MOMENTUM
    ALGEBRAIC_SOLVER:       GMRES,       ITERA=1000, TOLER=1.0e-6, ADAPTIVE, RATIO=0.01, KRYLOV=10, CONVERGENCE
    PRECONDITIONER:         DIAGONAL
  END_MOMENTUM

  CONTINUITY
    ALGEBRAIC_SOLVER:       DEFLATED_CG, ITERA=1000, TOLER=1.0e-7, ADAPTIVE, RATIO=0.01, UNSYMME, CONVERGENCE, CSR
    PRECONDITIONER:         DIAGONAL
  END_CONTINUITY

  DIVERGENCE_FREE
    ALGEBRAIC_SOLVER
      SOLVER:               DEFLATED_CG, COARSE: SPARSE
      CONVERGENCE:          ITERA=1000, TOLER=1.0e-10, ADAPTIVE, RATIO=1.0e-8
      OUTPUT:               CONVERGENCE
      PRECONDITIONER:       DIAGONAL
    END_ALGEBRAIC_SOLVER        
  END_DIVERGENCE


  DIRICHLET: MATRIX

  INTERNAL_FORCE: RESIDUAL


END_NUMERICAL_TREATMENT   
$------------------------------------------------------------
$------------------------------------------------------------
OUTPUT_&_POST_PROCESS
  POSTPROCESS PRESS, STEP= 10

END_OUTPUT_&_POST_PROCESS
$------------------------------------------------------------
BOUNDARY_CONDITIONS


  PARAMETERS
     INITIAL: CONSTANT, VALUE= 0.0, -1.0  COARSE
     DIVERGENCE: OFF, VALUES= 1.0, 1.0
   $$  VARIATION: NON_CONSTANT
  END_PARAMETERS 
 
  CODES, BOUNDARIES
  END_CODES

  CODES, NODES
    1 11 0.0 -1.0      $$ inflow
    2 11 0.0 0.0      $$ walls
    3 00 0.0 0.0      $$ outflow
    5 11 0.0 0.0      $$ contact (bottom and osci)


1 & 2 11 0.0 0.0       $$ in and rigid walls

1 & 5 11 0.0 0.0       $$ inflow and contact (osci)

2 & 3 11 0.0 0.0       $$ out and walls

3 & 5 11 0.0 0.0       $$ contact (bottom) and walls

   END_CODES

    CODES, NODES, DIVERGENCE
        1 & 2 1  1
    END_CODES


END_BOUNDARY_CONDITIONS  
$------------------------------------------------------------
