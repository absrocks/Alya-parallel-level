##
## to compile alya for mics, do first a module switch openmpi impi,
## with the corresponding openmpi and impi 
## check with module avail and see loaded with module list
##

source /opt/intel/impi/4.1.1.036/bin64/mpivars.sh
export I_MPI_MIC=enable
export I_MPI_HYDRA_BOOTSTRAP=ssh

declare -a hosts=(`cat $LSB_DJOB_HOSTFILE | tr ' ' '\n' | uniq`)
my_mpirun="mpirun -genv I_MPI_DEBUG 4 -genv OMP_NUM_THREADS 1"

for host in ${hosts[*]};
do
 my_mpirun+=" : -n 50 -host $host-mic0 /gpfs/projects/bsc21/WORK-MARIANO/SVN/Alya-mics-svn/Executables/unix/Alya.x banc";
done

echo $my_mpirun
$my_mpirun


